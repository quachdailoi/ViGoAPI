[2022-07-26 12:25:40.801 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 12:25:41.219 +07:00  INF]  Executed DbCommand (66ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
REVOKE CONNECT ON DATABASE "MaaSDB" FROM PUBLIC;
SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE datname = 'MaaSDB';
[2022-07-26 12:25:41.310 +07:00  INF]  Executed DbCommand (87ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP DATABASE "MaaSDB";
[2022-07-26 12:25:49.545 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 12:26:01.721 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 12:26:02.281 +07:00  INF]  Executed DbCommand (309ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE "MaaSDB";
[2022-07-26 12:26:02.459 +07:00  INF]  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
[2022-07-26 12:26:02.494 +07:00  INF]  Executed DbCommand (19ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (SELECT 1 FROM pg_catalog.pg_class c JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace WHERE c.relname='__EFMigrationsHistory');
[2022-07-26 12:26:02.498 +07:00  INF]  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
[2022-07-26 12:26:02.512 +07:00  INF]  Applying migration '20220726052549_InitialDB'.
[2022-07-26 12:26:02.563 +07:00  INF]  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE roles (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    description character varying(100) NOT NULL,
    name character varying(20) NOT NULL,
    created_at timestamp with time zone NULL,
    created_by integer NOT NULL,
    updated_at timestamp with time zone NULL,
    updated_by integer NOT NULL,
    deleted_at timestamp with time zone NULL,
    CONSTRAINT "PK_roles" PRIMARY KEY (id)
);
[2022-07-26 12:26:02.569 +07:00  INF]  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE users (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    code uuid NOT NULL,
    name character varying(50) NOT NULL,
    gender integer NOT NULL,
    status integer NOT NULL,
    date_of_birth timestamp with time zone NOT NULL,
    created_at timestamp with time zone NULL,
    created_by integer NOT NULL,
    updated_at timestamp with time zone NULL,
    updated_by integer NOT NULL,
    deleted_at timestamp with time zone NULL,
    CONSTRAINT "PK_users" PRIMARY KEY (id)
);
[2022-07-26 12:26:02.578 +07:00  INF]  Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE accounts (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    user_id integer NOT NULL,
    registration character varying(30) NULL,
    registration_type integer NOT NULL,
    verified boolean NOT NULL DEFAULT FALSE,
    role_id integer NULL,
    created_at timestamp with time zone NULL,
    created_by integer NOT NULL,
    updated_at timestamp with time zone NULL,
    updated_by integer NOT NULL,
    deleted_at timestamp with time zone NULL,
    CONSTRAINT "PK_accounts" PRIMARY KEY (id),
    CONSTRAINT "FK_accounts_roles_role_id" FOREIGN KEY (role_id) REFERENCES roles (id),
    CONSTRAINT "FK_accounts_users_user_id" FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE
);
[2022-07-26 12:26:02.584 +07:00  INF]  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE verified_codes (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    expired_time timestamp with time zone NOT NULL,
    code character varying(10) NOT NULL,
    registration character varying(30) NOT NULL,
    registration_type integer NOT NULL,
    status boolean NOT NULL,
    type integer NOT NULL,
    "AccountId" integer NULL,
    created_at timestamp with time zone NULL,
    created_by integer NOT NULL,
    updated_at timestamp with time zone NULL,
    updated_by integer NOT NULL,
    deleted_at timestamp with time zone NULL,
    CONSTRAINT "PK_verified_codes" PRIMARY KEY (id),
    CONSTRAINT "FK_verified_codes_accounts_AccountId" FOREIGN KEY ("AccountId") REFERENCES accounts (id)
);
[2022-07-26 12:26:02.588 +07:00  INF]  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO roles (id, created_at, created_by, deleted_at, description, name, updated_at, updated_by)
VALUES (1, TIMESTAMPTZ '2022-07-26 05:25:49.59901Z', 0, NULL, 'Role for booker', 'BOOKER', TIMESTAMPTZ '2022-07-26 05:25:49.59901Z', 0);
INSERT INTO roles (id, created_at, created_by, deleted_at, description, name, updated_at, updated_by)
VALUES (2, TIMESTAMPTZ '2022-07-26 05:25:49.599008Z', 0, NULL, 'Role for driver', 'DRIVER', TIMESTAMPTZ '2022-07-26 05:25:49.599008Z', 0);
[2022-07-26 12:26:02.590 +07:00  INF]  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id, code, created_at, created_by, date_of_birth, deleted_at, gender, name, status, updated_at, updated_by)
VALUES (1, 'ca4dd5a3-7dc3-483d-9536-4da7e291c2b4', TIMESTAMPTZ '2022-07-26 05:25:49.599011Z', 0, TIMESTAMPTZ '2022-07-26 05:25:49.599013Z', NULL, 1, 'Quach Dai Loi', 1, TIMESTAMPTZ '2022-07-26 05:25:49.599011Z', 0);
INSERT INTO users (id, code, created_at, created_by, date_of_birth, deleted_at, gender, name, status, updated_at, updated_by)
VALUES (2, '1f15cd0b-5070-48ae-a259-97ef8e47a094', TIMESTAMPTZ '2022-07-26 05:25:49.599014Z', 0, TIMESTAMPTZ '2022-07-26 05:25:49.599015Z', NULL, 1, 'Olivier', 1, TIMESTAMPTZ '2022-07-26 05:25:49.599014Z', 0);
[2022-07-26 12:26:02.593 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO accounts (id, created_at, created_by, deleted_at, registration, registration_type, role_id, updated_at, updated_by, user_id, verified)
VALUES (1, TIMESTAMPTZ '2022-07-26 05:25:49.599016Z', 0, NULL, 'loiqdse140970@fpt.edu.vn', 0, 2, TIMESTAMPTZ '2022-07-26 05:25:49.599016Z', 0, 2, TRUE);
INSERT INTO accounts (id, created_at, created_by, deleted_at, registration, registration_type, role_id, updated_at, updated_by, user_id, verified)
VALUES (2, TIMESTAMPTZ '2022-07-26 05:25:49.599016Z', 0, NULL, '+84837226239', 1, 2, TIMESTAMPTZ '2022-07-26 05:25:49.599016Z', 0, 2, TRUE);
INSERT INTO accounts (id, created_at, created_by, deleted_at, registration, registration_type, role_id, updated_at, updated_by, user_id, verified)
VALUES (3, TIMESTAMPTZ '2022-07-26 05:25:49.599017Z', 0, NULL, '+84837226239', 1, 1, TIMESTAMPTZ '2022-07-26 05:25:49.599017Z', 0, 1, TRUE);
[2022-07-26 12:26:02.596 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_accounts_registration_role_id" ON accounts (registration, role_id);
[2022-07-26 12:26:02.599 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_accounts_role_id" ON accounts (role_id);
[2022-07-26 12:26:02.602 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_accounts_user_id" ON accounts (user_id);
[2022-07-26 12:26:02.604 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_roles_description" ON roles (description);
[2022-07-26 12:26:02.607 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_verified_codes_AccountId" ON verified_codes ("AccountId");
[2022-07-26 12:26:02.612 +07:00  INF]  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT setval(
    pg_get_serial_sequence('roles', 'id'),
    GREATEST(
        (SELECT MAX(id) FROM roles) + 1,
        nextval(pg_get_serial_sequence('roles', 'id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('users', 'id'),
    GREATEST(
        (SELECT MAX(id) FROM users) + 1,
        nextval(pg_get_serial_sequence('users', 'id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('accounts', 'id'),
    GREATEST(
        (SELECT MAX(id) FROM accounts) + 1,
        nextval(pg_get_serial_sequence('accounts', 'id'))),
    false);
[2022-07-26 12:26:02.613 +07:00  INF]  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20220726052549_InitialDB', '6.0.6');
[2022-07-26 15:00:19.583 +07:00  INF]  User profile is available. Using 'C:\Users\quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2022-07-26 15:00:19.847 +07:00  INF]  Now listening on: https://localhost:7019
[2022-07-26 15:00:19.847 +07:00  INF]  Now listening on: http://localhost:5019
[2022-07-26 15:00:19.849 +07:00  INF]  Application started. Press Ctrl+C to shut down.
[2022-07-26 15:00:19.849 +07:00  INF]  Hosting environment: Development
[2022-07-26 15:00:19.849 +07:00  INF]  Content root path: D:\DotNet_Study\projects\MaaS\API\
[2022-07-26 15:00:20.835 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/index.html - -
[2022-07-26 15:00:21.189 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - -
[2022-07-26 15:00:21.199 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/index.html - - - 200 - text/html;charset=utf-8 368.7274ms
[2022-07-26 15:00:21.202 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - - - 200 11964 application/javascript;+charset=utf-8 12.8979ms
[2022-07-26 15:00:21.450 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - -
[2022-07-26 15:00:21.579 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 129.1542ms
[2022-07-26 15:00:35.552 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:00:35.668 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:00:35.703 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:00:37.151 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:00:38.095 +07:00  INF]  Executed DbCommand (83ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:00:38.167 +07:00  ERR]  An exception occurred while iterating over the results of a query for context type 'Infrastructure.Data.AppDbContext'.
System.InvalidCastException: Column 'deleted_at' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.GetFieldValue[T](Int32 ordinal)
   at lambda_method68(Closure , QueryContext , DbDataReader , ResultContext , SingleQueryResultCoordinator )
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
System.InvalidCastException: Column 'deleted_at' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.GetFieldValue[T](Int32 ordinal)
   at lambda_method68(Closure , QueryContext , DbDataReader , ResultContext , SingleQueryResultCoordinator )
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
[2022-07-26 15:00:38.398 +07:00  INF]  Executed action API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API) in 2689.5354ms
[2022-07-26 15:00:38.400 +07:00  INF]  Executed endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:00:38.405 +07:00  ERR]  An unhandled exception has occurred while executing the request.
System.InvalidCastException: Column 'deleted_at' is null.
   at Npgsql.ThrowHelper.ThrowInvalidCastException_NoValue(FieldDescription field)
   at Npgsql.NpgsqlDataReader.GetFieldValue[T](Int32 ordinal)
   at lambda_method68(Closure , QueryContext , DbDataReader , ResultContext , SingleQueryResultCoordinator )
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.AsyncEnumerator.MoveNextAsync()
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Query.ShapedQueryCompilingExpressionVisitor.SingleOrDefaultAsync[TSource](IAsyncEnumerable`1 asyncEnumerable, CancellationToken cancellationToken)
   at API.Services.AuthService.GetRoleAccountByRegistration(String registration, Int32 registrationType, String roleName) in D:\DotNet_Study\projects\MaaS\API\Services\AuthService.cs:line 65
   at API.Services.AuthService.GetBookerAccountByPhoneNumber(String phoneNumber) in D:\DotNet_Study\projects\MaaS\API\Services\AuthService.cs:line 47
   at API.Controllers.Booker.BookersController.SendPhoneLoginOtp(SendPhoneOtpRequest request) in D:\DotNet_Study\projects\MaaS\API\Controllers\Booker\BookersController.cs:line 31
   at Microsoft.AspNetCore.Mvc.Infrastructure.ActionMethodExecutor.TaskOfIActionResultExecutor.Execute(IActionResultTypeMapper mapper, ObjectMethodExecutor executor, Object controller, Object[] arguments)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeActionMethodAsync>g__Awaited|12_0(ControllerActionInvoker invoker, ValueTask`1 actionResultValueTask)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeNextActionFilterAsync>g__Awaited|10_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Rethrow(ActionExecutedContextSealed context)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.Next(State& next, Scope& scope, Object& state, Boolean& isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ControllerActionInvoker.<InvokeInnerFilterAsync>g__Awaited|13_0(ControllerActionInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeFilterPipelineAsync>g__Awaited|20_0(ResourceInvoker invoker, Task lastTask, State next, Scope scope, Object state, Boolean isCompleted)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Mvc.Infrastructure.ResourceInvoker.<InvokeAsync>g__Logged|17_1(ResourceInvoker invoker)
   at Microsoft.AspNetCore.Routing.EndpointMiddleware.<Invoke>g__AwaitRequestTask|6_0(Endpoint endpoint, Task requestTask, ILogger logger)
   at Microsoft.AspNetCore.Authorization.AuthorizationMiddleware.Invoke(HttpContext context)
   at Microsoft.AspNetCore.Authentication.AuthenticationMiddleware.Invoke(HttpContext context)
   at Swashbuckle.AspNetCore.SwaggerUI.SwaggerUIMiddleware.Invoke(HttpContext httpContext)
   at Swashbuckle.AspNetCore.Swagger.SwaggerMiddleware.Invoke(HttpContext httpContext, ISwaggerProvider swaggerProvider)
   at Microsoft.AspNetCore.Diagnostics.DeveloperExceptionPageMiddleware.Invoke(HttpContext context)
[2022-07-26 15:00:38.438 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - - - 500 - text/plain;+charset=utf-8 2886.8635ms
[2022-07-26 15:01:54.931 +07:00  INF]  User profile is available. Using 'C:\Users\quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2022-07-26 15:01:55.124 +07:00  INF]  Now listening on: https://localhost:7019
[2022-07-26 15:01:55.124 +07:00  INF]  Now listening on: http://localhost:5019
[2022-07-26 15:01:55.126 +07:00  INF]  Application started. Press Ctrl+C to shut down.
[2022-07-26 15:01:55.126 +07:00  INF]  Hosting environment: Development
[2022-07-26 15:01:55.126 +07:00  INF]  Content root path: D:\DotNet_Study\projects\MaaS\API\
[2022-07-26 15:01:55.651 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/index.html - -
[2022-07-26 15:01:56.036 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - -
[2022-07-26 15:01:56.045 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/index.html - - - 200 - text/html;charset=utf-8 399.0926ms
[2022-07-26 15:01:56.050 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - - - 200 11964 application/javascript;+charset=utf-8 13.1356ms
[2022-07-26 15:01:56.168 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - -
[2022-07-26 15:01:56.345 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 176.1670ms
[2022-07-26 15:02:00.091 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:02:00.196 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:02:00.226 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:02:01.641 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:02:02.573 +07:00  INF]  Executed DbCommand (89ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:02:02.771 +07:00  INF]  Executed DbCommand (10ms) [Parameters=[@__registration_0='?', @__registrationType_1='?' (DbType = Int32), @__codeType_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v."AccountId", v.code, v.created_at, v.created_by, v.deleted_at, v.expired_time, v.registration, v.registration_type, v.status, v.type, v.updated_at, v.updated_by
FROM verified_codes AS v
WHERE ((v.registration = @__registration_0) AND (v.registration_type = @__registrationType_1)) AND (v.type = @__codeType_2)
ORDER BY v.created_at DESC
LIMIT 1
[2022-07-26 15:02:02.786 +07:00  INF]  Executing BadRequestObjectResult, writing value of type 'API.Models.Response.Response'.
[2022-07-26 15:02:02.800 +07:00  INF]  Executed action API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API) in 2567.5539ms
[2022-07-26 15:02:02.802 +07:00  INF]  Executed endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:02:02.815 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - - - 400 - application/json;+charset=utf-8 2724.1418ms
[2022-07-26 15:03:44.575 +07:00  INF]  User profile is available. Using 'C:\Users\quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2022-07-26 15:03:44.825 +07:00  INF]  Now listening on: https://localhost:7019
[2022-07-26 15:03:44.826 +07:00  INF]  Now listening on: http://localhost:5019
[2022-07-26 15:03:44.868 +07:00  INF]  Application started. Press Ctrl+C to shut down.
[2022-07-26 15:03:44.868 +07:00  INF]  Hosting environment: Development
[2022-07-26 15:03:44.869 +07:00  INF]  Content root path: D:\DotNet_Study\projects\MaaS\API\
[2022-07-26 15:03:45.463 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/index.html - -
[2022-07-26 15:03:45.761 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - -
[2022-07-26 15:03:45.774 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/index.html - - - 200 - text/html;charset=utf-8 315.4980ms
[2022-07-26 15:03:45.774 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - - - 200 11964 application/javascript;+charset=utf-8 13.4069ms
[2022-07-26 15:03:45.887 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - -
[2022-07-26 15:03:46.033 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 146.3156ms
[2022-07-26 15:03:49.439 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:03:49.534 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:03:49.560 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:03:50.983 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:03:51.940 +07:00  INF]  Executed DbCommand (87ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:03:57.000 +07:00  INF]  Executed DbCommand (9ms) [Parameters=[@__registration_0='?', @__registrationType_1='?' (DbType = Int32), @__codeType_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v."AccountId", v.code, v.created_at, v.created_by, v.deleted_at, v.expired_time, v.registration, v.registration_type, v.status, v.type, v.updated_at, v.updated_by
FROM verified_codes AS v
WHERE ((v.registration = @__registration_0) AND (v.registration_type = @__registrationType_1)) AND (v.type = @__codeType_2)
ORDER BY v.created_at DESC
LIMIT 1
[2022-07-26 15:04:42.854 +07:00  INF]  User profile is available. Using 'C:\Users\quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2022-07-26 15:04:43.109 +07:00  INF]  Now listening on: https://localhost:7019
[2022-07-26 15:04:43.109 +07:00  INF]  Now listening on: http://localhost:5019
[2022-07-26 15:04:43.111 +07:00  INF]  Application started. Press Ctrl+C to shut down.
[2022-07-26 15:04:43.111 +07:00  INF]  Hosting environment: Development
[2022-07-26 15:04:43.111 +07:00  INF]  Content root path: D:\DotNet_Study\projects\MaaS\API\
[2022-07-26 15:04:43.967 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/index.html - -
[2022-07-26 15:04:44.289 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - -
[2022-07-26 15:04:44.297 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/index.html - - - 200 - text/html;charset=utf-8 337.7176ms
[2022-07-26 15:04:44.314 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - - - 200 11964 application/javascript;+charset=utf-8 25.2002ms
[2022-07-26 15:04:44.419 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - -
[2022-07-26 15:04:44.552 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 133.0717ms
[2022-07-26 15:04:47.960 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:04:48.038 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:04:48.067 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:04:49.408 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:04:50.323 +07:00  INF]  Executed DbCommand (93ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:10:13.158 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:10:13.465 +07:00  INF]  Executed DbCommand (59ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
REVOKE CONNECT ON DATABASE "MaaSDB" FROM PUBLIC;
SELECT pg_terminate_backend(pg_stat_activity.pid) FROM pg_stat_activity WHERE datname = 'MaaSDB';
[2022-07-26 15:10:13.515 +07:00  INF]  Executed DbCommand (46ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
DROP DATABASE "MaaSDB";
[2022-07-26 15:10:27.824 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:10:36.980 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:10:37.456 +07:00  INF]  Executed DbCommand (235ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE DATABASE "MaaSDB";
[2022-07-26 15:10:37.604 +07:00  INF]  Executed DbCommand (13ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE "__EFMigrationsHistory" (
    "MigrationId" character varying(150) NOT NULL,
    "ProductVersion" character varying(32) NOT NULL,
    CONSTRAINT "PK___EFMigrationsHistory" PRIMARY KEY ("MigrationId")
);
[2022-07-26 15:10:37.639 +07:00  INF]  Executed DbCommand (17ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (SELECT 1 FROM pg_catalog.pg_class c JOIN pg_catalog.pg_namespace n ON n.oid=c.relnamespace WHERE c.relname='__EFMigrationsHistory');
[2022-07-26 15:10:37.643 +07:00  INF]  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT "MigrationId", "ProductVersion"
FROM "__EFMigrationsHistory"
ORDER BY "MigrationId";
[2022-07-26 15:10:37.656 +07:00  INF]  Applying migration '20220726081028_InitialDB'.
[2022-07-26 15:10:37.706 +07:00  INF]  Executed DbCommand (6ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE roles (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    description character varying(100) NOT NULL,
    name character varying(20) NOT NULL,
    created_at timestamp with time zone NOT NULL,
    created_by integer NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    updated_by integer NOT NULL,
    deleted_at timestamp with time zone NULL,
    CONSTRAINT "PK_roles" PRIMARY KEY (id)
);
[2022-07-26 15:10:37.710 +07:00  INF]  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE users (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    code uuid NOT NULL,
    name character varying(50) NOT NULL,
    gender integer NOT NULL,
    status integer NOT NULL,
    date_of_birth timestamp with time zone NOT NULL,
    created_at timestamp with time zone NOT NULL,
    created_by integer NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    updated_by integer NOT NULL,
    deleted_at timestamp with time zone NULL,
    CONSTRAINT "PK_users" PRIMARY KEY (id)
);
[2022-07-26 15:10:37.719 +07:00  INF]  Executed DbCommand (9ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE accounts (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    user_id integer NOT NULL,
    registration character varying(30) NULL,
    registration_type integer NOT NULL,
    verified boolean NOT NULL DEFAULT FALSE,
    role_id integer NULL,
    created_at timestamp with time zone NOT NULL,
    created_by integer NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    updated_by integer NOT NULL,
    deleted_at timestamp with time zone NULL,
    CONSTRAINT "PK_accounts" PRIMARY KEY (id),
    CONSTRAINT "FK_accounts_roles_role_id" FOREIGN KEY (role_id) REFERENCES roles (id),
    CONSTRAINT "FK_accounts_users_user_id" FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE
);
[2022-07-26 15:10:37.725 +07:00  INF]  Executed DbCommand (5ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE TABLE verified_codes (
    id integer GENERATED BY DEFAULT AS IDENTITY,
    expired_time timestamp with time zone NOT NULL,
    code character varying(10) NOT NULL,
    registration character varying(30) NOT NULL,
    registration_type integer NOT NULL,
    status boolean NOT NULL,
    type integer NOT NULL,
    "AccountId" integer NULL,
    created_at timestamp with time zone NOT NULL,
    created_by integer NOT NULL,
    updated_at timestamp with time zone NOT NULL,
    updated_by integer NOT NULL,
    deleted_at timestamp with time zone NULL,
    CONSTRAINT "PK_verified_codes" PRIMARY KEY (id),
    CONSTRAINT "FK_verified_codes_accounts_AccountId" FOREIGN KEY ("AccountId") REFERENCES accounts (id)
);
[2022-07-26 15:10:37.728 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO roles (id, created_at, created_by, deleted_at, description, name, updated_at, updated_by)
VALUES (1, TIMESTAMPTZ '2022-07-26 08:10:27.876439Z', 0, NULL, 'Role for booker', 'BOOKER', TIMESTAMPTZ '2022-07-26 08:10:27.876439Z', 0);
INSERT INTO roles (id, created_at, created_by, deleted_at, description, name, updated_at, updated_by)
VALUES (2, TIMESTAMPTZ '2022-07-26 08:10:27.876437Z', 0, NULL, 'Role for driver', 'DRIVER', TIMESTAMPTZ '2022-07-26 08:10:27.876437Z', 0);
[2022-07-26 15:10:37.729 +07:00  INF]  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (id, code, created_at, created_by, date_of_birth, deleted_at, gender, name, status, updated_at, updated_by)
VALUES (1, 'da0ef573-6a50-4b0e-a0bb-8cadcf8d3331', TIMESTAMPTZ '2022-07-26 08:10:27.876439Z', 0, TIMESTAMPTZ '2022-07-26 08:10:27.876442Z', NULL, 1, 'Quach Dai Loi', 1, TIMESTAMPTZ '2022-07-26 08:10:27.876439Z', 0);
INSERT INTO users (id, code, created_at, created_by, date_of_birth, deleted_at, gender, name, status, updated_at, updated_by)
VALUES (2, 'bd5b5d29-26e9-4f60-9502-4b71bae15ea4', TIMESTAMPTZ '2022-07-26 08:10:27.876448Z', 0, TIMESTAMPTZ '2022-07-26 08:10:27.876449Z', NULL, 1, 'Olivier', 1, TIMESTAMPTZ '2022-07-26 08:10:27.876449Z', 0);
[2022-07-26 15:10:37.731 +07:00  INF]  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO accounts (id, created_at, created_by, deleted_at, registration, registration_type, role_id, updated_at, updated_by, user_id, verified)
VALUES (1, TIMESTAMPTZ '2022-07-26 08:10:27.87645Z', 0, NULL, 'loiqdse140970@fpt.edu.vn', 0, 2, TIMESTAMPTZ '2022-07-26 08:10:27.87645Z', 0, 2, TRUE);
INSERT INTO accounts (id, created_at, created_by, deleted_at, registration, registration_type, role_id, updated_at, updated_by, user_id, verified)
VALUES (2, TIMESTAMPTZ '2022-07-26 08:10:27.876451Z', 0, NULL, '+84837226239', 1, 2, TIMESTAMPTZ '2022-07-26 08:10:27.876451Z', 0, 2, TRUE);
INSERT INTO accounts (id, created_at, created_by, deleted_at, registration, registration_type, role_id, updated_at, updated_by, user_id, verified)
VALUES (3, TIMESTAMPTZ '2022-07-26 08:10:27.876451Z', 0, NULL, '+84837226239', 1, 1, TIMESTAMPTZ '2022-07-26 08:10:27.876451Z', 0, 1, TRUE);
[2022-07-26 15:10:37.735 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_accounts_registration_role_id" ON accounts (registration, role_id);
[2022-07-26 15:10:37.737 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_accounts_role_id" ON accounts (role_id);
[2022-07-26 15:10:37.740 +07:00  INF]  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_accounts_user_id" ON accounts (user_id);
[2022-07-26 15:10:37.742 +07:00  INF]  Executed DbCommand (3ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE UNIQUE INDEX "IX_roles_description" ON roles (description);
[2022-07-26 15:10:37.745 +07:00  INF]  Executed DbCommand (2ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
CREATE INDEX "IX_verified_codes_AccountId" ON verified_codes ("AccountId");
[2022-07-26 15:10:37.749 +07:00  INF]  Executed DbCommand (4ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
SELECT setval(
    pg_get_serial_sequence('roles', 'id'),
    GREATEST(
        (SELECT MAX(id) FROM roles) + 1,
        nextval(pg_get_serial_sequence('roles', 'id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('users', 'id'),
    GREATEST(
        (SELECT MAX(id) FROM users) + 1,
        nextval(pg_get_serial_sequence('users', 'id'))),
    false);
SELECT setval(
    pg_get_serial_sequence('accounts', 'id'),
    GREATEST(
        (SELECT MAX(id) FROM accounts) + 1,
        nextval(pg_get_serial_sequence('accounts', 'id'))),
    false);
[2022-07-26 15:10:37.750 +07:00  INF]  Executed DbCommand (1ms) [Parameters=[], CommandType='"Text"', CommandTimeout='30']
INSERT INTO "__EFMigrationsHistory" ("MigrationId", "ProductVersion")
VALUES ('20220726081028_InitialDB', '6.0.6');
[2022-07-26 15:10:42.183 +07:00  INF]  User profile is available. Using 'C:\Users\quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2022-07-26 15:10:42.486 +07:00  INF]  Now listening on: https://localhost:7019
[2022-07-26 15:10:42.486 +07:00  INF]  Now listening on: http://localhost:5019
[2022-07-26 15:10:42.496 +07:00  INF]  Application started. Press Ctrl+C to shut down.
[2022-07-26 15:10:42.496 +07:00  INF]  Hosting environment: Development
[2022-07-26 15:10:42.496 +07:00  INF]  Content root path: D:\DotNet_Study\projects\MaaS\API\
[2022-07-26 15:10:43.329 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/index.html - -
[2022-07-26 15:10:43.648 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - -
[2022-07-26 15:10:43.655 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/index.html - - - 200 - text/html;charset=utf-8 334.0531ms
[2022-07-26 15:10:43.656 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - - - 200 11964 application/javascript;+charset=utf-8 6.1333ms
[2022-07-26 15:10:43.798 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - -
[2022-07-26 15:10:43.945 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 147.3700ms
[2022-07-26 15:10:51.687 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:10:51.762 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:10:51.786 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:10:53.198 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:10:54.153 +07:00  INF]  Executed DbCommand (95ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:10:54.318 +07:00  INF]  Executed DbCommand (6ms) [Parameters=[@__registration_0='?', @__registrationType_1='?' (DbType = Int32), @__codeType_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v."AccountId", v.code, v.created_at, v.created_by, v.deleted_at, v.expired_time, v.registration, v.registration_type, v.status, v.type, v.updated_at, v.updated_by
FROM verified_codes AS v
WHERE ((v.registration = @__registration_0) AND (v.registration_type = @__registrationType_1)) AND (v.type = @__codeType_2)
ORDER BY v.created_at DESC
LIMIT 1
[2022-07-26 15:10:54.328 +07:00  INF]  Executing BadRequestObjectResult, writing value of type 'API.Models.Response.Response'.
[2022-07-26 15:10:54.339 +07:00  INF]  Executed action API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API) in 2547.485ms
[2022-07-26 15:10:54.341 +07:00  INF]  Executed endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:10:54.353 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - - - 400 - application/json;+charset=utf-8 2666.5141ms
[2022-07-26 15:11:28.752 +07:00  INF]  User profile is available. Using 'C:\Users\quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2022-07-26 15:11:29.018 +07:00  INF]  Now listening on: https://localhost:7019
[2022-07-26 15:11:29.019 +07:00  INF]  Now listening on: http://localhost:5019
[2022-07-26 15:11:29.034 +07:00  INF]  Application started. Press Ctrl+C to shut down.
[2022-07-26 15:11:29.034 +07:00  INF]  Hosting environment: Development
[2022-07-26 15:11:29.034 +07:00  INF]  Content root path: D:\DotNet_Study\projects\MaaS\API\
[2022-07-26 15:11:29.855 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/index.html - -
[2022-07-26 15:11:30.159 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - -
[2022-07-26 15:11:30.165 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/index.html - - - 200 - text/html;charset=utf-8 315.3933ms
[2022-07-26 15:11:30.166 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - - - 200 11964 application/javascript;+charset=utf-8 7.4471ms
[2022-07-26 15:11:30.280 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - -
[2022-07-26 15:11:30.406 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 125.3513ms
[2022-07-26 15:11:34.140 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:11:34.240 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:11:34.268 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:11:35.700 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:11:36.639 +07:00  INF]  Executed DbCommand (89ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:12:17.004 +07:00  INF]  User profile is available. Using 'C:\Users\quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2022-07-26 15:12:17.200 +07:00  INF]  Now listening on: https://localhost:7019
[2022-07-26 15:12:17.200 +07:00  INF]  Now listening on: http://localhost:5019
[2022-07-26 15:12:17.202 +07:00  INF]  Application started. Press Ctrl+C to shut down.
[2022-07-26 15:12:17.202 +07:00  INF]  Hosting environment: Development
[2022-07-26 15:12:17.202 +07:00  INF]  Content root path: D:\DotNet_Study\projects\MaaS\API\
[2022-07-26 15:12:18.059 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/index.html - -
[2022-07-26 15:12:18.428 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - -
[2022-07-26 15:12:18.436 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/index.html - - - 200 - text/html;charset=utf-8 381.2461ms
[2022-07-26 15:12:18.436 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - - - 200 11964 application/javascript;+charset=utf-8 7.1116ms
[2022-07-26 15:12:18.559 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - -
[2022-07-26 15:12:18.676 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 116.7878ms
[2022-07-26 15:12:26.252 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:12:26.343 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:12:26.369 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:12:27.711 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:12:28.718 +07:00  INF]  Executed DbCommand (92ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:12:28.887 +07:00  INF]  Executed DbCommand (9ms) [Parameters=[@__registration_0='?', @__registrationType_1='?' (DbType = Int32), @__codeType_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v."AccountId", v.code, v.created_at, v.created_by, v.deleted_at, v.expired_time, v.registration, v.registration_type, v.status, v.type, v.updated_at, v.updated_by
FROM verified_codes AS v
WHERE ((v.registration = @__registration_0) AND (v.registration_type = @__registrationType_1)) AND (v.type = @__codeType_2)
ORDER BY v.created_at DESC
LIMIT 1
[2022-07-26 15:12:57.284 +07:00  INF]  User profile is available. Using 'C:\Users\quach\AppData\Local\ASP.NET\DataProtection-Keys' as key repository and Windows DPAPI to encrypt keys at rest.
[2022-07-26 15:12:57.475 +07:00  INF]  Now listening on: https://localhost:7019
[2022-07-26 15:12:57.475 +07:00  INF]  Now listening on: http://localhost:5019
[2022-07-26 15:12:57.478 +07:00  INF]  Application started. Press Ctrl+C to shut down.
[2022-07-26 15:12:57.478 +07:00  INF]  Hosting environment: Development
[2022-07-26 15:12:57.478 +07:00  INF]  Content root path: D:\DotNet_Study\projects\MaaS\API\
[2022-07-26 15:12:58.301 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/index.html - -
[2022-07-26 15:12:58.616 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - -
[2022-07-26 15:12:58.626 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/index.html - - - 200 - text/html;charset=utf-8 330.1783ms
[2022-07-26 15:12:58.626 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/_framework/aspnetcore-browser-refresh.js - - - 200 11964 application/javascript;+charset=utf-8 7.6484ms
[2022-07-26 15:12:58.739 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - -
[2022-07-26 15:12:58.912 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 172.8398ms
[2022-07-26 15:13:01.977 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:13:02.072 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:13:02.104 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:13:03.495 +07:00  INF]  Entity Framework Core 6.0.6 initialized 'AppDbContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.5+9d79af6e2586d5d28da253ac075706a5575a1743' with options: MaxPoolSize=1024 
[2022-07-26 15:13:04.412 +07:00  INF]  Executed DbCommand (87ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:13:04.591 +07:00  INF]  Executed DbCommand (6ms) [Parameters=[@__registration_0='?', @__registrationType_1='?' (DbType = Int32), @__codeType_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v."AccountId", v.code, v.created_at, v.created_by, v.deleted_at, v.expired_time, v.registration, v.registration_type, v.status, v.type, v.updated_at, v.updated_by
FROM verified_codes AS v
WHERE ((v.registration = @__registration_0) AND (v.registration_type = @__registrationType_1)) AND (v.type = @__codeType_2)
ORDER BY v.created_at DESC
LIMIT 1
[2022-07-26 15:13:06.155 +07:00  INF]  Executed DbCommand (11ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Int32), @p4='?' (DbType = DateTime), @p5='?' (DbType = DateTime), @p6='?', @p7='?' (DbType = Int32), @p8='?' (DbType = Boolean), @p9='?' (DbType = Int32), @p10='?' (DbType = DateTime), @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO verified_codes ("AccountId", code, created_at, created_by, deleted_at, expired_time, registration, registration_type, status, type, updated_at, updated_by)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
[2022-07-26 15:13:06.172 +07:00  INF]  Executing OkObjectResult, writing value of type 'API.Models.Response.Response'.
[2022-07-26 15:13:06.183 +07:00  INF]  Executed action API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API) in 4073.4599ms
[2022-07-26 15:13:06.185 +07:00  INF]  Executed endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:13:06.208 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - - - 200 - application/json;+charset=utf-8 4230.9678ms
[2022-07-26 15:13:06.278 +07:00  ERR]  Domain.Entities.VerifiedCode Add function error.
System.ObjectDisposedException: Cannot access a disposed context instance. A common cause of this error is disposing a context instance that was resolved from dependency injection and then later trying to use the same context instance elsewhere in your application. This may occur if you are calling 'Dispose' on the context instance, or wrapping it in a using statement. If you are using dependency injection, you should let the dependency injection container take care of disposing context instances.
Object name: 'AppDbContext'.
   at Microsoft.EntityFrameworkCore.DbContext.CheckDisposed()
   at Microsoft.EntityFrameworkCore.DbContext.get_DbContextDependencies()
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Infrastructure.Data.Repositories.GenericRepository`1.Add(T entity) in D:\DotNet_Study\projects\MaaS\Infrastructure\Data\Repositories\GenericRepository.cs:line 34
[2022-07-26 15:13:20.198 +07:00  INF]  Request starting HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - -
[2022-07-26 15:13:20.200 +07:00  INF]  Executing endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:13:20.200 +07:00  INF]  Route matched with {action = "SendPhoneLoginOtp", controller = "Bookers"}. Executing controller action with signature System.Threading.Tasks.Task`1[Microsoft.AspNetCore.Mvc.IActionResult] SendPhoneLoginOtp(API.Models.Requests.SendPhoneOtpRequest) on controller API.Controllers.Booker.BookersController (API).
[2022-07-26 15:13:20.210 +07:00  INF]  Executed DbCommand (7ms) [Parameters=[@__roleName_2='?', @__registration_0='?', @__registrationType_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.created_at, a.created_by, a.deleted_at, a.registration, a.registration_type, a.role_id, a.updated_at, a.updated_by, a.user_id, a.verified, u.id, u.code, u.created_at, u.created_by, u.date_of_birth, u.deleted_at, u.gender, u.name, u.status, u.updated_at, u.updated_by, r0.id, r0.created_at, r0.created_by, r0.deleted_at, r0.description, r0.name, r0.updated_at, r0.updated_by
FROM accounts AS a
INNER JOIN (
    SELECT r.id
    FROM roles AS r
    WHERE r.name = @__roleName_2
) AS t ON a.role_id = t.id
INNER JOIN users AS u ON a.user_id = u.id
LEFT JOIN roles AS r0 ON a.role_id = r0.id
WHERE (a.registration = @__registration_0) AND (a.registration_type = @__registrationType_1)
LIMIT 1
[2022-07-26 15:13:20.213 +07:00  INF]  Executed DbCommand (2ms) [Parameters=[@__registration_0='?', @__registrationType_1='?' (DbType = Int32), @__codeType_2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT v.id, v."AccountId", v.code, v.created_at, v.created_by, v.deleted_at, v.expired_time, v.registration, v.registration_type, v.status, v.type, v.updated_at, v.updated_by
FROM verified_codes AS v
WHERE ((v.registration = @__registration_0) AND (v.registration_type = @__registrationType_1)) AND (v.type = @__codeType_2)
ORDER BY v.created_at DESC
LIMIT 1
[2022-07-26 15:13:20.607 +07:00  INF]  Executing OkObjectResult, writing value of type 'API.Models.Response.Response'.
[2022-07-26 15:13:20.607 +07:00  INF]  Executed action API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API) in 407.2015ms
[2022-07-26 15:13:20.607 +07:00  INF]  Executed endpoint 'API.Controllers.Booker.BookersController.SendPhoneLoginOtp (API)'
[2022-07-26 15:13:20.607 +07:00  INF]  Request finished HTTP/2 GET https://localhost:7019/api/bookers/phone/send-login-otp?PhoneNumber=%2B84837226239 - - - 200 - application/json;+charset=utf-8 409.7694ms
